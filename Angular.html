<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>angular注册动态验证</title>
	<link rel="stylesheet" type="text/css" href="bootstrap-3.3.7-dist/css/bootstrap.min.css">
	<style type="text/css">
		.wrapper{
			margin: 20px auto;
			width: 200px;
		}
		.error{
			color:#a10;
		}
		/*p.error{
			display: none;
		}*/
		input.error{
			border: 1px solid #a10;
		}
	</style>
</head>
<body ng-app="myApp" ng-controller="signUpController">
	<div class="wrapper">
		<h2>注册</h2>
		<form name="signUpForm" ng-submit="submitForm()">
		<div class="form-group" ng-class="{ 'has-success':signUpForm.username.$valid}">
			<label>用户名：</label>
			<input type="text" class="form-control" name="username" ng-model="userdata.username" ng-minlength="4" ng-maxlength="32" required>
			<p class="error" ng-if="signUpForm.username.$error.required && signUpForm.username.$touched">用户名不可为空</p>
			<p class="error" ng-if="(signUpForm.username.$error.minlength || signUpForm.username.$error.maxlength) && signUpForm.username.$touched">用户名应在4-32位之间</p>
		</div>
		<div class="form-group" ng-class="{ 'has-success':signUpForm.password.$valid}">
			<label>密码：</label>
			<input type="password" name="password" class="form-control" ng-model="userdata.password" ng-minlength="6" ng-maxlength="255" required>
			<p class="error" ng-if="signUpForm.password.$error.required && signUpForm.password.$touched">密码不可为空</p>
			<p class="error" ng-if="(signUpForm.password.$error.minlength || signUpForm.password.$error.maxlength) && signUpForm.password.$touched">密码长度应在6-255位之间</p>
		</div>
		<div class="form-group" ng-class="{ 'has-success':signUpForm.password2.$valid}">
			<label>确认密码：</label>
			<input type="password" name="password2" class="form-control" ng-model="userdata.password2" compare="userdata.password" required>
			<p class="error" ng-if="signUpForm.password2.$error.compare && signUpForm.password2.$touched">两次输入不一致</p>
		</div>
		<button class="btn btn-default" type="submit">注册</button>
	</form>
	</div>
	
	<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.8/angular.min.js"></script>
	<script type="text/javascript">
		angular.module('myApp',[])
			.controller('signUpController',function($scope){
				$scope.userdata={};
				$scope.submitForm = function (){
					console.log($scope.userdata);
					if($scope.signUpForm.$invalid){
						alert('请检查信息！');
					}else{
						alert('提交成功！'); 
					}
				}
			})
			.directive('compare',function(){
				var o = {};
				o.strict = 'AE';
				o.scope = {
					orgText:'=compare'
				}
				o.require = 'ngModel';
				o.link = function(sco,ele,att,con){
					con.$validators.compare = function(y){
						return y == sco.orgText;
					}

					sco.$watch('orgText',function(){
						con.$validate();
					})
				}
				return o;
			})
	</script>
</body>
</html>